/*+----------------------------------------------------------------+
  |	Title:		Grp.hpp [共通管理]
  |	Comment:	スプライトグループ
  |	Author:		K.Takayanagi
  +----------------------------------------------------------------+*/
/*+----------------------------------------------------------------+
  |	Include		インクルードヘッダ
  +----------------------------------------------------------------+*/
#include "env.hpp"
#include "Grp.hpp"

/*+----------------------------------------------------------------+
  |	Define		デファイン定義
  +----------------------------------------------------------------+*/
/*+----------------------------------------------------------------+
  |	Struct		構造体型宣言
  +----------------------------------------------------------------+*/
/*+----------------------------------------------------------------+
  |	Prototype	プロトタイプ宣言
  +----------------------------------------------------------------+*/
/*+----------------------------------------------------------------+
  |	Global		グローバルデータ型定義
  +----------------------------------------------------------------+*/
/*+----------------------------------------------------------------+
  |	Program		プログラム実装
  +----------------------------------------------------------------+*/
//------------------------
// コンストラクタ
//------------------------
CGrp::CGrp( void ){
	clear();
}

//------------------------
// デストラクタ
//------------------------
CGrp::~CGrp( void ){
	clear();
}

//------------------------
// クリア
//------------------------
void CGrp::clear( void ){
	m_nSprNum = 0;
    for( int i=0; i<NUM_SPR_IN_GRP; i++ ){
        m_pArrSpr[i] = NULL;
    }
}

//------------------
// バイナリの適用
//------------------
bool CGrp::applyBin( CGrpBinData* pBin ){
    // 用心
    if( pBin == NULL ){
        return( false );
    }

    // 有効なスプライトの抽出
    m_nSprNum  = 0;
    while( m_nSprNum < NUM_SPR_IN_GRP ){
        // 指定が無効なら抜ける
        eSPR sprId = pBin->getSprAt( m_nSprNum );
        if( ! IS_SPR_VALID( sprId ) ){
            break;
        }

        // スプライトの取得（※ここでスプライトがないのは何か変）
        m_pArrSpr[m_nSprNum] = CSprMgr::GetSpr( sprId );
        if( m_pArrSpr[m_nSprNum] == NULL ){
            return( false );
        }

        // 要素数を増やす
        m_nSprNum++;
    }
    
	return( true );
}
